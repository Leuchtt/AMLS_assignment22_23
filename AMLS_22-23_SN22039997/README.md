# Introduction
This project focuses on the solution of four tasks: A1, A2, B1, B2 based on machine learning algorithm. Logistic regression and CNN models are used for task A1; logistic regression and SVM models are used for task A2; decision tree and random forest models are used for task B1 and B2. The model building, hyper-parameter and cross-validation tuning are implemented for each algorithm to realise, optimise and test the model.


# Role of each file
A1:  Logistic_regreesion.ipynb---Builds logistic regreesion model to realise gender detection
     CNN_train.ipynb---Builds and train the CNN model for gender detection
     CNN.ipynb---Uses the model parameter saved to test the performance of the model on the test dataset
     cnn_model.pt---The file with CNN model parameters saved by saved by CNN_train.ipynb 

A2:  Logistic_regreesion.ipynb---Builds logistic regreesion model to realise smiling detection
     SVM.ipynb---Builds SVM model to realise smiling detection

B1:  decision_tree.ipynb---Builds decision tree model to realise face shape recognition
     random_forest.ipynb---Builds random forest model to realise face shape recognition

B2:  sunglass_remove.ipynb---Preprocesses data to classify sunglasses-wearing, and save the new train and test dataset without sunglasses
     decision_tree.ipynb---Builds decision tree model to realise face shape recognition
     random_forest.ipynb---Builds random forest model to realise face shape recognition
     
# Dependencies

  The code is programmed on python 3.9 based on Jupyter Notebook. The following packages are needed for this project:

    NumPy
    Pandas
    sklean
    cv2
    torch
    torchvision
    Matplotlib
    Seaborn
    PIL
    



# Training the model

  To train the deep association metric model on your datasets you can reference to https://github.com/nwojke/cosine_metric_learning  approach which is provided as a separate repository.
  
  Be careful that the code ignores everything but person. For your task do not forget to change :
  
  [deep_sort_yolov3/yolo.py]   Lines 100 to 101 :
  
          if predicted_class != 'person' : 
               continue 

# Note 
  You can use any Detector you like to replace Keras_version YOLO to get bboxes , for it is to slow !
  
  Model file model_data/mars-small128.pb need by deep_sort had convert to tensorflow-1.4.0
  
  Deep sort 程序结构见 “model_data/DeepSORT”，如有错误欢迎联系修改。
 
# Test only

  Speed : when only run yolo detection about 11-13 fps  , after add deep_sort about 11.5 fps (GTX1060 6G)
 
  Test result video : https://www.bilibili.com/video/av23500163/ generated by this project
 

